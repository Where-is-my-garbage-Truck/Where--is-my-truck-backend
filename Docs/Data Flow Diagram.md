â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                              DATA FLOW DIAGRAM                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FLOW 1: DRIVER SENDS LOCATION (Every 5-30 seconds)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ“± Driver App                    ğŸ–¥ï¸ Backend                      ğŸ—„ï¸ Database
       â”‚                               â”‚                               â”‚
       â”‚  1. Get GPS coordinates       â”‚                               â”‚
       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚                               â”‚
       â”‚  {lat, lng, speed,            â”‚                               â”‚
       â”‚   heading, timestamp}         â”‚                               â”‚
       â”‚                               â”‚                               â”‚
       â”‚      IF ONLINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                               â”‚  2. Save to DB                â”‚
       â”‚                               â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚
       â”‚                               â”‚                               â”‚
       â”‚                               â”‚  3. Update truck's            â”‚
       â”‚                               â”‚     last_location             â”‚
       â”‚                               â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚
       â”‚                               â”‚                               â”‚
       â”‚                               â”‚  4. Check nearby users        â”‚
       â”‚                               â”‚     for notifications         â”‚
       â”‚                               â”‚                               â”‚
       â”‚      IF OFFLINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
       â”‚                               â”‚                               â”‚
       â”‚  Store locally â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
       â”‚  [Queue: +1]                  â”‚                               â”‚
       â”‚                               â”‚                               â”‚
       â”‚      WHEN BACK ONLINE â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
       â”‚                               â”‚                               â”‚
       â”‚  Sync all queued locations    â”‚                               â”‚
       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚  Batch insert                 â”‚
       â”‚  [Queue: 0]                   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚
       â”‚                               â”‚                               â”‚


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FLOW 2: USER GETS TRUCK LOCATION (Poll every 3-5 seconds OR WebSocket)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ“± User App                      ğŸ–¥ï¸ Backend                      ğŸ—ºï¸ Google Maps
       â”‚                               â”‚                               â”‚
       â”‚  1. Request truck location    â”‚                               â”‚
       â”‚  GET /track/{truck_id}        â”‚                               â”‚
       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚                               â”‚
       â”‚                               â”‚                               â”‚
       â”‚                               â”‚  2. Get from DB               â”‚
       â”‚                               â”‚  (cached last_location)       â”‚
       â”‚                               â”‚                               â”‚
       â”‚                               â”‚  3. Calculate ETA             â”‚
       â”‚                               â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚
       â”‚                               â”‚  Google Directions API        â”‚
       â”‚                               â”‚  (with traffic)               â”‚
       â”‚                               â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
       â”‚                               â”‚  {duration, distance,         â”‚
       â”‚                               â”‚   traffic_condition}          â”‚
       â”‚                               â”‚                               â”‚
       â”‚  4. Response                  â”‚                               â”‚
       â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚                               â”‚
       â”‚  {                            â”‚                               â”‚
       â”‚    truck_lat, truck_lng,      â”‚                               â”‚
       â”‚    user_lat, user_lng,        â”‚                               â”‚
       â”‚    distance_km: 2.3,          â”‚                               â”‚
       â”‚    eta_minutes: 12,           â”‚                               â”‚
       â”‚    traffic: "moderate",       â”‚                               â”‚
       â”‚    truck_status: "moving",    â”‚                               â”‚
       â”‚    last_update: "10 sec ago"  â”‚                               â”‚
       â”‚  }                            â”‚                               â”‚
       â”‚                               â”‚                               â”‚
       â”‚  5. Update map UI             â”‚                               â”‚
       â”‚                               â”‚                               â”‚


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FLOW 3: ALERT USER WHEN TRUCK IS NEAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ–¥ï¸ Backend                       ğŸ“ Notification                 ğŸ“± User App
       â”‚                               â”‚                               â”‚
       â”‚  1. On every location update  â”‚                               â”‚
       â”‚     check all users nearby    â”‚                               â”‚
       â”‚                               â”‚                               â”‚
       â”‚  2. For each user:            â”‚                               â”‚
       â”‚     - Calculate distance      â”‚                               â”‚
       â”‚     - If distance < threshold â”‚                               â”‚
       â”‚       AND not already alerted â”‚                               â”‚
       â”‚                               â”‚                               â”‚
       â”‚  3. Send notification         â”‚                               â”‚
       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚                               â”‚
       â”‚                               â”‚                               â”‚
       â”‚     Option A: Push            â”‚  4a. Push Notification        â”‚
       â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚
       â”‚                               â”‚  "ğŸš› Truck 5 mins away!"      â”‚
       â”‚                               â”‚                               â”‚
       â”‚     Option B: Missed Call     â”‚  4b. Phone rings once         â”‚
       â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚
       â”‚                               â”‚  ğŸ“ *ring* *ring* (auto cut)  â”‚
       â”‚                               â”‚                               â”‚
       â”‚     Option C: In-App Sound    â”‚  4c. App plays alert          â”‚
       â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚
       â”‚                               â”‚  ğŸ”Š "Garbage truck nearby!"   â”‚
       â”‚                               â”‚                               â”‚
       â”‚  5. Mark user as "alerted"    â”‚                               â”‚
       â”‚     (don't alert again today) â”‚                               â”‚
       â”‚                               â”‚                               â”‚


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FLOW 4: DRIVER STARTS/STOPS DUTY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ“± Driver App                    ğŸ–¥ï¸ Backend                      ğŸ—„ï¸ Database
       â”‚                               â”‚                               â”‚
       â”‚  â•â•â• MORNING: START DUTY â•â•â•  â”‚                               â”‚
       â”‚                               â”‚                               â”‚
       â”‚  1. Tap "START" button        â”‚                               â”‚
       â”‚  POST /truck/1/start          â”‚                               â”‚
       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚  2. Set truck.is_active=true  â”‚
       â”‚                               â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚
       â”‚                               â”‚                               â”‚
       â”‚                               â”‚  3. Reset today's alerts      â”‚
       â”‚                               â”‚     for all users in zone     â”‚
       â”‚                               â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚
       â”‚                               â”‚                               â”‚
       â”‚  4. Start GPS tracking        â”‚                               â”‚
       â”‚     (background service)      â”‚                               â”‚
       â”‚                               â”‚                               â”‚
       â”‚  â•â•â• EVENING: STOP DUTY â•â•â•   â”‚                               â”‚
       â”‚                               â”‚                               â”‚
       â”‚  1. Tap "STOP" button         â”‚                               â”‚
       â”‚  POST /truck/1/stop           â”‚                               â”‚
       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚  2. Set truck.is_active=false â”‚
       â”‚                               â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º       â”‚
       â”‚                               â”‚                               â”‚
       â”‚  3. Stop GPS tracking         â”‚                               â”‚
       â”‚  4. Sync any remaining        â”‚                               â”‚
       â”‚     offline locations         â”‚                               â”‚
       â”‚                               â”‚                               â”‚